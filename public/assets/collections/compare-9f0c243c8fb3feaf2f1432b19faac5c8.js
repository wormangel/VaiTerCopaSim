$(document).ready(function(){function e(){$("#fav_list_spinner").show(),$.ajax({url:"/favorites/get_favs",success:function(e){var a=$("#fav_list");if(a.empty(),e.favs.length>0)$.each(e.favs,function(e,t){var n=$("<li></li>"),o=$('<a href="/collections/compare/'+t.favorite.uid+'"></a>'),s=$('<img src="http://graph.facebook.com/'+t.favorite.uid+'/picture?type=small"></img>');o.append(s),o.append("   "+t.favorite.name),n.append(o),a.append(n)});else{var t=$("<li></li>"),n=$('<span class="navbar-text">Voc\xea n\xe3o tem favoritos!</span>');t.append(n),a.append(t)}$("#fav_list_spinner").hide()},error:function(e){alert(e.responseJSON.message)}})}$("#btn_toggle_favorite").click(function(){var a=$(this).data("uid"),t=$(this).data("action"),n=$("#btn_toggle_favorite"),o=$("#btn_toggle_favorite_caption"),s=$("#btn_toggle_favorite_spinner");"add"!=t&"remove"!=t||(o.hide(),s.show(),$.ajax("add"==t?{url:"/favorites/create?uid="+a,success:function(){s.hide(),o.text("Remover dos favoritos"),o.show(),n.removeClass("btn-warning"),n.addClass("btn-danger"),n.data("action","remove"),e()},error:function(e){alert(e.responseJSON.message)}}:{url:"/favorites/destroy?uid="+a,success:function(){s.hide(),o.text("Adicionar aos favoritos"),o.show(),n.removeClass("btn-danger"),n.addClass("btn-warning"),n.data("action","add"),e()},error:function(e){alert(e.responseJSON.message)}}))})});