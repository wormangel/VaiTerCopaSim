$(document).ready(function(){function a(){$("#fav_list_spinner").show(),$.ajax({url:"/favorites/get_favs",success:function(a){var e=$("#fav_list");if(e.empty(),a.favs.length>0)$.each(a.favs,function(a,t){var n=$("<li></li>"),o=$('<a href="/collections/compare/'+t.favorite.uid+'"></a>'),i=$('<img src="http://graph.facebook.com/'+t.favorite.uid+'/picture?type=small"></img>');o.append(i),o.append("   "+t.favorite.name),n.append(o),e.append(n)});else{var t=$("<li></li>"),n=$('<span class="navbar-text">Voc\xea n\xe3o tem favoritos!</span>');t.append(n),e.append(t)}$("#fav_list_spinner").hide()},error:function(a){alert(a.message)}})}$("#btn_toggle_favorite").click(function(){var e=$(this).data("uid"),t=$(this).data("action"),n=$("#btn_toggle_favorite"),o=$("#btn_toggle_favorite_caption"),i=$("#btn_toggle_favorite_spinner");"add"!=t&"remove"!=t||(o.hide(),i.show(),$.ajax("add"==t?{url:"/favorites/create?uid="+e,success:function(){i.hide(),o.text("Remover dos favoritos"),o.show(),n.removeClass("btn-warning"),n.addClass("btn-danger"),n.data("action","remove"),a()},error:function(a){alert(a.responseJSON.message)}}:{url:"/favorites/destroy?uid="+e,success:function(){i.hide(),o.text("Adicionar aos favoritos"),o.show(),n.removeClass("btn-danger"),n.addClass("btn-warning"),n.data("action","add"),a()},error:function(a){alert(a.message)}}))})});